<div>
	<h1>Character Sheet</h1>
	<div class="inventory" v-on:click="onBaseInventoryClick">

		<h2>Inventory</h2>
		
		<h4>Dropped:</h4>
		<table border="1">
			<thead>
				<tr>
					<td>Item Name</td>
					<td>Qty</td>
					<td>Weight</td>
					<td>Type</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody>
				<tr v-for="entry in char.inventory.dropped.list">
					<td><input type="text" v-on:blur="entry.item.name=setValidNameOfInput($event.target, entry.item.name)" v-bind:value="entry.item.name"></input></td>
					<td><input type="number" v-model="entry.qty" number min="1"></input></td>
					<td><input type="number" v-model="entry.item.weight" number min="0"></input></td>
					<td>{{ entry.item.getTypeLabel() }}</td>
					<td>
						<a href="javascript:;" v-on:click="char.inventory.packItemEntryFromGround(entry)">Pack</a>
						<a href="javascript:;" v-on:click="char.inventory.equipItemEntryFromGround(entry)">Equip</a>
						<a href="javascript:;" v-on:click="char.inventory.dropped.delete(entry)">Delete</a>
					</td>
				</tr>
				<tr>
					<td><input type="text" v-model="droppedEntry.e.item.name" required v-on:focus="focusInRowField(droppedEntry, 1)" v-on:blur="focusOutRowField(droppedEntry, 1)"></input></td>
					<td><input type="number" v-model="droppedEntry.e.qty" number min="1" v-on:focus="focusInRowField(droppedEntry, 2)" v-on:blur="focusOutRowField(droppedEntry, 2)"></input></td>
					<td><input type="number" v-model="droppedEntry.e.weight" number min="0" v-on:focus="focusInRowField(droppedEntry, 4)" v-on:blur="focusOutRowField(droppedEntry, 4)"></input></td>
					<td>
						MiscItem
					</td>
					
				</tr>
				
				
			</tbody>
		</table>
		
		<h4>Packed: <label style="font-size:10px">Drop?</label><input type="checkbox" v-model="char.inventory.dropPack"></input></h4>
		
		<table border="1">
			<thead>
				<tr>
					<td>Item Name</td>
					<td>Qty</td>
					<td>Weight</td>
					<td>Type</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody>
				<tr v-for="entry in char.inventory.packed.list">
					<td><input type="text" v-on:blur="entry.item.name=setValidNameOfInput($event.target, entry.item.name)" v-bind:value="entry.item.name"></input></td>
					<td><input type="number" v-model="entry.qty" number min="1"></input></td>
					<td><input type="number" v-model="entry.item.weight" number min="0"></input></td>
					<td>{{ entry.item.getTypeLabel() }}</td>
	
					<td>
						<a href="javascript:;" v-on:click="char.inventory.dropItemEntryFromPack(entry)">Drop</a>
						<a href="javascript:;" v-on:click="char.inventory.equipItemEntryFromPack(entry)">Equip</a>
						<a href="javascript:;" v-on:click="char.inventory.packed.delete(entry)">Delete</a>
					</td>
				</tr>
				<tr>
					<td><input type="text" v-model="packedEntry.e.item.name" required v-on:focus="focusInRowField(packedEntry, 1)" v-on:blur="focusOutRowField(packedEntry, 1)"></input></td>
					<td><input type="number" v-model="packedEntry.e.qty" number min="1" v-on:focus="focusInRowField(packedEntry, 2)" v-on:blur="focusOutRowField(packedEntry, 2)"></input></td>
					<td><input type="number" v-model="packedEntry.e.weight" number min="0" v-on:focus="focusInRowField(packedEntry, 4)" v-on:blur="focusOutRowField(packedEntry, 4)"></input></td>
					<td>MiscItem</td>
				</tr>
			</tbody>
		</table>
					
		<h3>Equipment details</h3>
		
		
		<h4>Shields:</h4>
		<table border="1">
			<thead>
				<tr>
					<td style="width:155px">Shield Name</td>
					<td style="width:35px">AV</td>
					<td style="width:35px">Block</td>
					<td style="width:45px">Weight</td>
					<td>Coverage</td>
					<td>Tags</td>
					<td style="width:130px">Kept at?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('shield',$event)">
				<tr v-for="(entry,i) in char.inventory.shields">
					<td><input type="text" v-on:blur="entry.shield.name=setValidNameOfInput($event.target, entry.shield.name)" v-bind:value="entry.shield.name"></input></td>
					<td><input type="number" v-model="entry.shield.AV" number min="1"></input></td>
					<td><input type="number" v-model="entry.shield.blockTN" number min="0"></input></td>
					<td><input type="number" v-model="entry.shield.weight" number min="0"></input></td>
					<td  v-on:click="stopPropagation" class="gotbtn focus"><input type="text" readonly :value="entry.shield.coverage"></input><button v-on:click="requestCurWidget('coverage',i)">[|]</button>
						<div class="pop-widget" v-if="isVisibleWidget('shield','coverage', i)">
							Widget goes here
						</div>
					</td>
					<td><input type="text"></input></td>
					<td><input type="text" v-model="entry.unheldRemark"></input></td>
					<td>
						<select number :value="entry.held" v-on:change="holdItemHandler(entry, $event.target.value)">
							<option value="0">No</option>
							<option value="2" :disabled="entry.shield.get_twoHanded()">Off-hand</option>
							<option value="1" :disabled="entry.shield.get_twoHanded()">Master-hand</option>
							<option value="3">Both hands</option>
						</select>
					</td>
					
					<td>
						<a href="javascript:;" v-on:click="char.inventory.packEquipedShield(entry)">Pack</a>
						<a href="javascript:;" v-on:click="char.inventory.dropEquipedShield(entry)">Drop</a>
						<a href="javascript:;" v-on:click="char.inventory.dropEquipedShield(entry, true)">Delete</a>
					</td>
				</tr>
				<tr>
					<td><input type="text" v-on:focus="focusInRowField(shieldEntry, 1)" v-on:blur="focusOutRowField(shieldEntry, 1)" v-model="shieldEntry.e.shield.name" required></input></td>
					<td><input type="number" v-on:focus="focusInRowField(shieldEntry, 2)" v-on:blur="focusOutRowField(shieldEntry, 2)" v-model="shieldEntry.e.shield.AV" number min="1"></input></td>
					<td><input type="number" v-on:focus="focusInRowField(shieldEntry, 4)" v-on:blur="focusOutRowField(shieldEntry, 4)" v-model="shieldEntry.e.shield.block" number min="0"></input></td>
					<td><input type="number" v-on:focus="focusInRowField(shieldEntry, 8)" v-on:blur="focusOutRowField(shieldEntry, 8)" v-model="shieldEntry.e.shield.weight" number min="0"></input></td>
					<td v-on:click="stopPropagation"><input type="text" class="focusable" readonly v-on:focus="focusInRowField(shieldEntry, 16)" v-on:blur="focusOutRowField(shieldEntry, 16)" :value="shieldEntry.e.shield.coverage"></input>
						<div class="pop-widget" v-on:mousedown="focusInRowField(shieldEntry, (1<<20))"  v-if="shieldEntry.focusedFlags & (16|(1<<20))">
							Widget goes here
						</div>
						
					</td>
					<td><input type="text" v-on:focus="focusInRowField(shieldEntry, 32)" v-on:blur="focusOutRowField(shieldEntry, 32)"></input></td>
					<td><input type="text" v-model="shieldEntry.unheldRemark" v-on:focus="focusInRowField(shieldEntry,64)" v-on:blur="focusOutRowField(shieldEntry,64)"></input></td>	
				</tr>
			</tbody>
		</table>
		
		<h4>Weapons:</h4>
		<table border="1">
			<thead>
				<tr>
					<td>Melee Weap Name</td>
					<td>Type</td>
					<td  style="width:30px">Hands</td>
					<td style="width:20px">Reach</td>
					<td style="width:45px">Swing</td>
					<td style="width:45px">Thrust</td>
					<td style="width:35px">DTN(G)</td>
					<td>Tags</td>
					<td>Weight</td>
					<td>Kept at?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('meleeWeap', $event)">
				<tr v-for="(entry,itemIndex) in char.inventory.weapons">
					<td><input type="text" v-on:blur="entry.weapon.name=setValidNameOfInput($event.target, entry.weapon.name)" v-bind:value="entry.weapon.name"></input></td>
					<td v-on:click="stopPropagation">
						<select number data-type="profs" :data-index="itemIndex" v-on:change="onProfSelectChange($event, entry.weapon)">
							<option selected v-if="entry.weapon.isMultipleCoreProf() || entry.weapon.hasCustomProf()" :value="entry.weapon.profs">
								{{ entry.weapon.profLabels() }}
							</option>
							<option v-for="(p, i) in coreMeleeProfs" :value="(1 << i)">{{ p.name }}</option>
							<option v-for="(p, i) in coreRangedProfs" :value="-1*(1 << i)">&gt;{{ p.name }}</option>
							<option style="color:grey;" value="0" :selected="isVisibleWidget('meleeWeap','profs', itemIndex)">select multiple...</option>
						</select>	
						<div class="pop-widget" v-if="isVisibleWidget('meleeWeap','profs', itemIndex)">
							Widget goes here
						</div>
					</td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td></td>
					<td><input type="text" v-model="entry.unheldRemark"></input></td>
					<td>
						<select number :value="entry.held" v-on:change="holdItemHandler(entry, $event.target.value)"  >
							<option value="0">No</option>
							<option value="1" :disabled="entry.weapon.get_twoHanded()">Master-hand</option>
							<option value="2" :disabled="entry.weapon.get_twoHanded()">Off-hand</option>
							<option value="3">Both hands</option>
						</select>
					</td>
					<td>
						<a href="javascript:;" v-on:click="char.inventory.packEquipedWeapon(entry)">Pack</a>
						<a href="javascript:;" v-on:click="char.inventory.dropEquipedWeapon(entry)">Drop</a>
						<a href="javascript:;" v-on:click="char.inventory.dropEquipedWeapon(entry, true)">Delete</a>
					</td>
				</tr>
				<tr v-if="!weaponEntry.e.weapon.ranged">
					<td><input type="text" v-model="weaponEntry.e.weapon.name" v-on:focus="focusInRowField(weaponEntry,1)" v-on:blur="focusOutRowField(weaponEntry,1)"></input></td>
					<td  v-on:click="stopPropagation">
						<select number data-type="profs" data-index="-1" v-on:focus="focusInRowField(weaponEntry,2)" v-on:blur="focusOutRowField(weaponEntry,2)" v-on:change="onProfSelectChange($event, weaponEntry.e.weapon)">
							<option selected v-if="weaponEntry.e.weapon.isMultipleCoreProf() || weaponEntry.e.weapon.hasCustomProf()" :value="weaponEntry.e.weapon.profs">
								{{ weaponEntry.e.weapon.profLabels() }}
							</option>
							<option v-for="(p, i) in coreMeleeProfs" :value="(1 << i)">{{ p.name }}</option>
							<option v-for="(p, i) in coreRangedProfs" :value="-1*(1 << i)">&gt;{{ p.name }}</option>
							<option style="color:grey;" value="0" :selected="isVisibleWidget('meleeWeap','profs', -1)">select multiple...</option>
						</select>	
						<div class="pop-widget" v-if="isVisibleWidget('meleeWeap','profs', -1)">
							Widget goes here
						</div>
					</td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,4)" v-on:blur="focusOutRowField(weaponEntry,4)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,8)" v-on:blur="focusOutRowField(weaponEntry,8)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,16)" v-on:blur="focusOutRowField(weaponEntry,16)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,32)" v-on:blur="focusOutRowField(weaponEntry,32)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,64)" v-on:blur="focusOutRowField(weaponEntry,64)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,128)" v-on:blur="focusOutRowField(weaponEntry,128)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(weaponEntry,256)" v-on:blur="focusOutRowField(weaponEntry,256)"></input></td>
					<td><input type="text" v-model="weaponEntry.e.unheldRemark" v-on:focus="focusInRowField(weaponEntry,1024)" v-on:blur="focusOutRowField(weaponEntry,1024)"></input></td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<td>Bow Name</td>
					<td>Type</td>
					<td>Range</td>
					<td>ATN</td>
					<td>Damage</td>
					<td>Req STR</td>
					<td>Special</td>
					<td>Weight</td>
					<td>Kept at?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('bow', $event)">
				<tr v-if="weaponEntry.e.weapon.isBow()">
					<td>
						<input type="text"></input>
					</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<td>Crossbow Name</td>
					<td>Type</td>
					<td>Range</td>
					<td>ATN</td>
					<td>Damage</td>
					<td>Span</td>
					<td>SpanTool</td>
					<td>Special</td>
					<td>Weight</td>
					<td>Kept at?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('crossbow', $event)">
				<tr v-if="weaponEntry.e.weapon.isCrossbow()">
					<td>
						<input type="text"></input>
					</td>
				</tr>
			</tbody>
			<thead>
				<tr>
					<td>Firearm Name</td>
					<td>Type</td>
					<td>Range</td>
					<td>ATN</td>
					<td>Damage</td>
					<td>Load</td>
					<td>Ammunition</td>
					<td>Tags</td>
					<td>Weight</td>
					<td>Kept at?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('firearm', $event)">
				<tr v-if="weaponEntry.e.weapon.isFirearm()">
					<td>
						<table>
							<tr>
								<td><input type="text"></input></td>
								<td><input type="text"></input></td>
							</tr>
						</table>
					</td>
				</tr>
			</tbody>
		</table>
					
					
		<h4>MiscItems:</h4>
		<table border="1">
			<thead>
				<tr>
					<td>MiscItem Name</td>
					<td>Tags</td>
					<td>Weight</td>
					<td>Kept At?</td>
					<td>Held?</td>
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('miscItem', $event)">
				<tr v-for="entry in char.inventory.equipedNonMeleeItems">
					<td><input type="text" v-on:blur="entry.item.name=setValidNameOfInput($event.target, entry.item.name)" v-bind:value="entry.item.name"></input></td>
					<td></td>
					<td><input type="number" number min="0" v-model="entry.item.weight"></input></td>
					<td><input type="text" v-model="entry.unheldRemark"></input></td>
					<td>
						<select number :value="entry.held" v-on:change="holdItemHandler(entry, $event.target.value)"  >
							<option value="0">No</option>
							<option value="1" :disabled="entry.item.get_twoHanded()">Master-hand</option>
							<option value="2" :disabled="entry.item.get_twoHanded()">Off-hand</option>
							<option value="3">Both hands</option>
						</select>
					</td>
					<td>
						<a href="javascript:;" v-on:click="char.inventory.packMiscItem(entry)">Pack</a>
						<a href="javascript:;" v-on:click="char.inventory.dropMiscItem(entry)">Drop</a>
						<a href="javascript:;" v-on:click="char.inventory.dropMiscItem(entry, true)">Delete</a>
					</td>
				</tr>
				<tr>
					<td><input type="text" v-model="miscItemEntry.e.item.name" v-on:focus="focusInRowField(miscItemEntry,1)" v-on:blur="focusOutRowField(miscItemEntry,1)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(miscItemEntry,2)" v-on:blur="focusOutRowField(miscItemEntry,2)"></input></td>
					<td><input type="number" number min="0" v-model="miscItemEntry.e.item.weight" v-on:focus="focusInRowField(miscItemEntry,4)" v-on:blur="focusOutRowField(miscItemEntry,4)"></input></td>
					<td><input type="text" v-model="miscItemEntry.e.unheldRemark" v-on:focus="focusInRowField(miscItemEntry,8)" v-on:blur="focusOutRowField(miscItemEntry,8)"></input></td>	
				</tr>
			</tbody>
		</table>		
			
		
		<h4>Armor:</h4>
		<table border="1">
			<thead>
				<tr>
					<td>Armor Name</td>
					<td>AVC</td>
					<td>AVP</td>
					<td>AVB</td>
					<td>Coverage</td>
					<td>Weight</td>
					<td>Tags</td>
					
					<td class="actions"><i>Actions</i></td>
				</tr>
			</thead>
			<tbody v-on:click="setCurWidgetSection('armor', $event)">
				<tr v-for="armor in char.inventory.wornArmor">
					<td><input type="text" v-model="armor.name"></input></td>
					<td><input type="text" v-model="armor.AVC"></input></td>
					<td><input type="text" v-model="armor.AVP"></input></td>
					<td><input type="text" v-model="armor.AVB"></input></td>
					<td><input type="text" :value="armor.coverage"></input></td>
					<td><input type="number" min="0" number v-model="armor.weight"></input></td>
					<td><input type="text"></input></td>
					
					<td>
						<a href="javascript:;">Pack</a>
						<a href="javascript:;">Drop</a>
						<a href="javascript:;">Delete</a>
					</td>
				</tr>
				<tr>
					<td><input type="text" v-model="armorEntry.e.name" v-on:focus="focusInRowField(armorEntry,1)" v-on:blur="focusOutRowField(armorEntry,1)"></input></td>
					<td><input type="text" v-model="armorEntry.e.AVC" v-on:focus="focusInRowField(armorEntry,2)" v-on:blur="focusOutRowField(armorEntry,2)"></input></td>
					<td><input type="text" v-model="armorEntry.e.AVP" v-on:focus="focusInRowField(armorEntry,4)" v-on:blur="focusOutRowField(armorEntry,4)"></input></td>
					<td><input type="text" v-model="armorEntry.e.AVB" v-on:focus="focusInRowField(armorEntry,8)" v-on:blur="focusOutRowField(armorEntry,8)"></input></td>
					<td><input type="text" :value="armorEntry.e.coverage" v-on:focus="focusInRowField(armorEntry,16)" v-on:blur="focusOutRowField(armorEntry,16)"></input></td>
					<td><input type="number" min="0" number v-model="armorEntry.e.weight" v-on:focus="focusInRowField(armorEntry,32)" v-on:blur="focusOutRowField(armorEntry,32)"></input></td>
					<td><input type="text" v-on:focus="focusInRowField(armorEntry,64)" v-on:blur="focusOutRowField(armorEntry,64)"></input></td>
				</tr>
			</tbody>
		</table>		
		
		
		<hr/>
		<button v-on:click="saveSheet()">Save Sheet</button>
		
		<div>
			<br/>
			<textarea character-set="UTF-8" v-model="copyToClipboard"></textarea>
		</div>
					
		<button v-on:click="loadSheet()">Load Sheet</button>
	</div>
</div>